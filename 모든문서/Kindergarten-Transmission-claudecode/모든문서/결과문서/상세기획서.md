# Kindergarten Edufine Integration System - Implementation Plan

## Goal Description
Build a web-based ERP utility for private kindergartens to easily input accounting slips (income/expense) and automatically transmit/register them into the Edufine (Korea's educational financial system). The app UI will benchmark 'DMB iCube'.

## Architecture & Tech Stack
- **Frontend/Backend:** Next.js 15 (App Router), React 19, Tailwind CSS 4
- **Database:** PostgreSQL with Prisma ORM
- **Automation (Bank Scraping \u0026 RPA):** Playwright (Node.js) to automate logging into specific banks (fast account lookup/scraping) and submitting forms to Edufine.
- **Infrastructure:** Docker Compose (postgres-compose.yml)

## Proposed Changes

### 1. Project Initialization & Dependencies
- Set up Next.js 15 with Tailwind 4.
- Configure Prisma with PostgreSQL.
- Add necessary UI libraries (e.g., Lucide React for icons, Radix UI or custom components for the iCube-like interface).
- Set up `playwright` for the RPA worker.

### 2. Database Schema (Prisma)
- `User`: System admins and internal staff (Role-based access).
- `Kindergarten`: Kindergarten info (Name, Edufine ID, Encrypted PW, Certificate info placeholder).
- `AccountCode`: Accounting subjects categorization.
- `Transaction`: Slip entries (Income, Expense) linked to Kindergarten and AccountCode.
- `TransmissionLog`: Logs of RPA transmissions to Edufine (Success, Failure, Error messages).

### 3. API Routes & Server Actions
- JWT-based authentication for admins and users.
- CRUD for transactions.
- Triggers the Playwright script to sync pending transactions for a specific kindergarten.

### 4. UI/UX Implementation (Benchmarking iCube)
- Layout with a left sidebar (Navigation) and header (Kindergarten selection, User profile).
- Main overview/statistics.
- Manage client kindergartens.
- Grid/Table-based slip entry UI (Spreadsheet-like capability for fast input).
- Account mappings and system settings.

### 5. Automation Worker (Bank Scraping \u0026 Edufine RPA)
- Playwright script that runs headlessly.
- **Scraping**: Logs into banks using ID/PW (fast account lookup/스피드조회), scrapes translation history HTML, and parses into DB records.
- **Edufine RPA**: Logs into Edufine.
- Navigates to the accounting slip page.
- Selects the mapped account codes.
- Fills in amounts and details.
- Submits and captures the result/screenshot for confirmation.

## Verification Plan

### Automated Tests
- Unit tests for Prisma data mappers.
- Mock the Edufine RPA endpoints using Playwright's network interception if possible.

### Manual Verification
- Run `docker-compose up` to start the PostgreSQL DB.
- Run `npm run dev` and navigate through all UI screens.
- Test inserting a dummy slip and trigger transmission (against a test environment or logging out before submission).
- Verify the UX looks professional and similar to the requested iCube benchmark.
- Test mobile view responsiveness.
